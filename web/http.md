- [什么是HTTP](#什么是HTTP)
    - [什么是资源](#什么是资源)
- [HTTP报文结构](#HTTP报文结构)
    - [请求消息首行](#请求消息首行)
    - [响应消息首行](#响应消息首行)
    - [消息头行](#消息头行)
    - [消息体](#消息体)
- [一个简单的HTTP通信过程](#一个简单的HTTP通信过程)
- [其他HTTP方法](#其他HTTP方法)
    - [HEAD方法](#HEAD方法)
    - [POST方法](#POST方法)
- [结束语](#结束语)
<a name="什么是HTTP"></a>
# 什么是HTTP
HTTP全称为Hypertext Transfer Protocol，即超文本传输协议。HTTP是一种用来在万维网传输资源的网络通信协议。一般来说HTTP底层使用TCP/IP协议。

<a name="什么是资源"></a>
## 什么是资源
HTTP是用来传输资源的，资源不仅仅指文件。一份资源是一个可以使用URL来标识的信息块。其最常见的形式是文件，但是也可以是一次动态查询的返回结果，CGI脚本的输出，一份文档等等。在实际应用中，当前的HTTP资源几乎都是由文件或服务端脚本输出构成。

<a name="HTTP报文结构"></a>
# HTTP报文结构
类似于大多数网络协议，HTTP也采用客户端-服务器模型。HTTP客户端打开一个连接并向HTTP服务器发送一个请求，服务器对请求返回一个响应，其中就包含着客户端请求的资源。完成响应后，服务器就关闭与客户端之间的连接，这使得HTTP成为一个无状态协议，比如，在通信之间不需要保存任何连接信息。

请求与响应消息的格式十分类型，都包含以下内容：
- 首行
- 零或多行的消息头
- 一个空白行
- 可选的消息体

具体格式如下：
<首行，请求消息和响应消息不同>
头1：值
头2：值
头3：值

<可选的消息体，例如文件或者其他请求数据；
可以为多行，甚至可以是二进制数据 $&*%@!^$@>

首行和消息头应该以CRLF结尾。

<a name="请求消息首行"></a>
## 请求消息首行
请求和响应消息的首行有所不同。请求消息的首行由空格分开的三部分组成：方法名，请求消息的路径和HTTP的版本号。一个典型的请求行如下：

```
GET /path/to/file/index.html HTTP/1.0
```
注意：
- *GET*是最常见的HTTP方法，其表示向服务器请求一个资源。其他方法包括*POST*和*HEAD*。方法名应该使用大写。
- 路径是URL中位于主机名后的部分，也称为URI
- HTTP版本号采用“HTTP/x.x”格式，大写。

<a name="响应消息首行"></a>
## 响应消息首行
响应消息的首行，称为状态行。同样由空格分开的三部分组成：HTTP版本号，响应状态码和由英文标识的状态码描述信息。典型格式如下：
```
HTTP/1.0 200 OK
```
或者
```
HTTP/1.0 404 Not Found
```
注意：
- HTTP版本号如之前所有，格式采用“HTTP/x.x”，大写。
- 状态码是为了方便计算机读取。描述信息则是为了方便人类识别，所以可能会存在变化。
- 状态码是一个三位数的整型数字。其首位标识了响应的不同分类：
	- 1xx表示只有一条信息性消息。
	- 2xx表示不同类型的成功响应。
	- 3xx表示重定向客户到另外的URL。
	- 4xx表示客户端发生错误。
	- 5xx表示服务端发生错误。

最常见的状态码如下：
200 OK：请求成功，请求的资源置于消息体中。
404 Not Found：请求的资源不存在。
301 Moved Permanently
302 Moved Temporarily
303 See Other：资源已经被移动到另一个URL下，并且需要客户端自动重新获取。
500 Server Error：出现不可预料的服务端错误。最常见的原因是服务端脚本有错误的语法，执行失败，或其他无法正确运行的原因。

<a name="消息头行"></a>
## 消息头行
消息头提供请求或响应的信息，或者是关于消息体的一些信息。

消息头通常以每行一个头信息，格式为“头名：值”，以CRLF结尾。
- 如前所述，消息头的每一行应该以CRLF结尾，不过一般来说以LF结尾也可以正常识别。
- 头名是大小写不敏感的，而其值可能大小写敏感。
- 在“：”和值之间可以包括任意数量的空格或tab。
- 以空白或tab开头行，实际是上一行的延续，只是为了方便阅读被分为多行。

因此，一下消息头是等同的：
```
Header1:very-long-value-first, very-long-value-second

HEADER1:	very-long-value-first,
			very-long-value-second
```

HTTP 1.0定义了16中头信息，HTTP 1.1定义了46种，但是均不是必须的。

<a name="消息体"></a>
## 消息体
一个HTTP消息可以包含一个消息体，其位于消息头之后。消息体可以用来放置请求的资源，或者在发生错误的时候存放详细的描述信息。在请求中，消息体用于存放客户端上传的资源。

如果一个HTTP消息包含消息体，那么消息头中通常需要以下信息描述消息体：
- Content-Type：消息体给出消息体中数据的格式，例如text/html、image/gif.
- Content-Length：消息体的字节数。

<a name="一个简单的HTTP通信过程"></a>
# 一个简单的HTTP通信过程
为了获取一份文件，其URL为
```
http://www.xxhost.com/path/file.html
```
首先打开一个socket，连接到*www.somehost.com*,如果URL中未指明端口，则默认端口为80。然后通过socket发送以下内容：
```
GET /path/file.html HTTP/1.0
From: xxuser@vendor.com
User-Agent:HTTPTool/1.0
[空白行]
```

服务器应该通过上面的socket响应以下内容：
```
HTTP/1.0 200 OK
Date:Fri, 5 Jun 2018 11:21:00 GMT
Content-Type:text/html
Content-Length:1234

<html>
<body>
<h1>File Title</h1>
...
</body>
</html>
```
发送往响应后，服务器关闭socket。

<a name="其他HTTP方法"></a>
# 其他HTTP方法
除了GET以外，最常见的HTTP方法是*HEAD*和*POST*。

<a name="HEAD方法"></a>
## HEAD方法
*HEAD*方法非常类似于*GET*，除了其要求服务器仅仅返回响应头，而不是真正的资源。这对于想要检查资源的属性却并不想真正下载资源的情况非常有用。

<a name="POST方法"></a>
## POST方法
*POST*方法用于向服务器上传资源。其与*GET*的区别如下：
- 消息体中包含了上传的资源，头中也包含了响应的描述信息，如Content-Type、Content-Length。
- 请求的URI不是想要获取资源的路径，通常是服务器用于处理上传资源的程序路径。
- 收到的HTTP响应通常是处理后的输出，而不是静态文件内容。

<a name="结束语"></a>
# 结束语
已上就是HTTP的基本内容。以上内容可以满足简单的HTTP 1.0网络程序编写。

